% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_kalman.R
\name{FitKalman}
\alias{FitKalman}
\title{Fitting k-box models to abrupt 4xCO2 experiments}
\usage{
FitKalman(inits, T1, N, alpha = 0, maxeval = 1e+05)
}
\arguments{
\item{inits}{list of parameter starting values containing the following
elements:
\itemize{
  \item \code{gamma} - stochastic forcing correlation parameter;
  \item \code{C} - vector of box heat capacities;
  \item \code{kappa} - vector of heat transfer coefficients;
  \item \code{epsilon} - deep ocean heat uptake efficacy factor;
  \item \code{sigma_eta} - stochastic forcing standard deviation parameter;
  \item \code{sigma_xi} - standard deviation of stochastic temperature
  disturbances;
  \item \code{F_4xCO2} - effective radiative forcing due to CO2 quadrupling.
}}

\item{T1}{time series of global mean surface temperature.}

\item{N}{time series of top-of-the-atmosphere net downward radiative flux.}

\item{alpha}{quadratic penalty applied to heat capacity of deep-ocean box.}

\item{maxeval}{maximum number of iterations in BOBYQA optimization algorithm.}
}
\value{
\code{FitKalman} returns a list containing the following elements:
\itemize{
  \item \code{mle} - vector of logged maximum likelihood parameter estimates;
  \item \code{vcov} - approximate covariance matrix of estimated parameters;
  \item \code{se} - vector of approximate standard errors of logged parameter
  estimates;
  \item \code{confint} - matrix with two rows containing lower and upper
  bounds of approximate 95 percent confidence intervals for logged
  parameters;
  \item \code{AIC} - Akaike's information criterion score;
  \item \code{p} - list of maximum likelihood parameter estimates;
  \item \code{m} - list containing matrix representation of fitted model;
  \item \code{tau} - vector containing characteristic timescales of fitted
  model;
  \item \code{T1} - time series of global mean surface temperature used in
  model fitting;
  \item \code{N} - time series of top-of-the-atmosphere net downward
  radiative flux used in model fitting;
  \item \code{kf} - fitted Kalman filter object (see \code{\link[FKF]{fkf}});
  \item \code{step} - matrix with k + 1 rows containing expected trajectories
  of fitted model state variables F, T1, ..., Tk under abrupt 4xCO2 forcing;
  \item \code{transient} - matrix with k rows containing expected
  trajectories of box temperatures under a one-percent-per-year increasing
  CO2 scenario;
  \item \code{impulse} - matrix with k rows containing expected
  trajectories of box temperatures under a unit-impulse forcing scenario;
  \item \code{ECS} - equilibrium climate sensitivity (equilibrium
  temperature increase after doubling CO2);
  \item \code{TCR} - transient climate response (temperature increase after
  70 years of one-percent-per-year increasing CO2).
}
}
\description{
\code{FitKalman} fits a k-box model to time series of global mean surface
temperature and top-of-the-atmosphere net downward radiative flux from an
abrupt 4xCO2 climate model experiment. Parameters are estimated using the
Kalman filter and maximum likelihood estimation. Estimated parameters are
returned in a list along with a suite of useful derived quantities.
}
\examples{
# load CMIP5 abrupt 4xCO2 runs
data("CMIP5")

# set three-box model starting values
inits3 <- list(
  gamma = 2.0,
  C = c(5.0, 20.0, 100.0),
  kappa = c(1.0, 2.0, 1.0),
  epsilon = 1.0,
  sigma_eta = 0.5,
  sigma_xi = 0.5,
  F_4xCO2 = 5.0
)

# fit three-box model to HadGEM2-ES
HadGEM2 <- with(CMIP5$MOHC, {
  FitKalman(inits = inits3, T1 = temp, N = flux)
})

# print parameter estimates
print(HadGEM2$p)
}
\seealso{
\code{\link{BuildMatrices}}, \code{\link{SimStepData}}.
}
