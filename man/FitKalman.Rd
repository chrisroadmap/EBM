% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_kalman.R
\name{FitKalman}
\alias{FitKalman}
\title{Fitting k-box models to abrupt 4xCO2 experiments}
\usage{
FitKalman(inits, T1, N, maxeval = 1e+05)
}
\arguments{
\item{inits}{list of parameter starting values.}

\item{T1}{time series of global mean surface temperature.}

\item{N}{time series of top-of-the-atmosphere net downward radiative flux.}

\item{maxeval}{maximum number of iterations in BOBYQA optimization algorithm.}
}
\value{
\code{FitKalman} returns a list containing fitted model output.
}
\description{
\code{FitKalman} fits a k-box model to time series of global mean surface
temperature and top-of-the-atmosphere net downward radiative flux from an
abrupt 4xCO2 climate model experiment. Parameters are estimated using the
Kalman filter and maximum likelihood estimation. Estimated parameters are
returned in a list along with a suite of useful derived quantities.
}
\examples{
# load CMIP5 abrupt 4xCO2 runs
data("CMIP5")

# set three-box model starting values
inits3 <- list(
  gamma = 2.0,
  C = c(5.0, 20.0, 100.0),
  kappa = c(1.0, 2.0, 1.0),
  epsilon = 1.0,
  sigma_eta = 0.5,
  sigma_xi = 0.5,
  F_4xCO2 = 5.0
)

# fit three-box model to HadGEM2-ES
HadGEM2 <- with(CMIP5$MOHC, {
  FitKalman(inits = inits3, T1 = temp, N = flux)
})

# print parameter estimates
print(HadGEM2$p)
}
